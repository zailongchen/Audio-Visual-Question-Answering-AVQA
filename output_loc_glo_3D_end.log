nohup: ignoring input
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torch/distributed/launch.py:178: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.23.1
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.23.1
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.23.1
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.23.1
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
INFO:root:********************************************************
INFO:root:****************** Experiment setting ******************
INFO:root:label_train dir --------- ./data/json_update/avqa-train.json
INFO:root:label_val dir ----------- ./data/json_update/avqa-val.json
INFO:root:label_test dir ---------- ./data/json_update/avqa-test.json
INFO:root:audio dir --------------- ./data/feats/vggish
INFO:root:posi_video dir ---------- /data/avst/10f_video_2plus1/
INFO:root:nega_video dir ---------- /data/avst/10f_video_2plus1/
INFO:root:batch size -------------- 24
INFO:root:num of epoches ---------- 15
INFO:root:learning rate ----------- 0.0001
INFO:root:name of model ----------- AVQA_Fusion_Net
INFO:root:train or test ----------- train
INFO:root:model save dir ---------- ./data/checkpoints/checkpoint_loc_glo_3D_end
INFO:root:num of dataloader workers 2
INFO:root:gpu id ------------------ 0,1,2,3
INFO:root:********************************************************
INFO:torch.distributed.distributed_c10d:Added key: store_based_barrier_key:1 to store for rank: 0
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.
  warnings.warn(
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=R2Plus1D_18_Weights.KINETICS400_V1`. You can also use `weights=R2Plus1D_18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:torch.distributed.distributed_c10d:Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.
  warnings.warn(
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=R2Plus1D_18_Weights.KINETICS400_V1`. You can also use `weights=R2Plus1D_18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:root:------------ Audio-Visual Spatial-Temporal Model ------------ 

/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.
  warnings.warn(
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=R2Plus1D_18_Weights.KINETICS400_V1`. You can also use `weights=R2Plus1D_18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.
  warnings.warn(
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=R2Plus1D_18_Weights.KINETICS400_V1`. You can also use `weights=R2Plus1D_18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:root:-------------- training dataset preparation --------------

INFO:root:--------- training dataset preparation completed ----------

INFO:root:length of training dataset ----------- 333

INFO:root:-------------- validation dataset preparation --------------

INFO:root:-------- validation dataset preparation completed ----------
INFO:root:length of validation dataset ----------- 191
INFO:root:-------------- start training --------------

/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torch/nn/functional.py:1949: UserWarning: nn.functional.tanh is deprecated. Use torch.tanh instead.
  warnings.warn("nn.functional.tanh is deprecated. Use torch.tanh instead.")
[W reducer.cpp:1251] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torch/nn/functional.py:1949: UserWarning: nn.functional.tanh is deprecated. Use torch.tanh instead.
  warnings.warn("nn.functional.tanh is deprecated. Use torch.tanh instead.")
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torch/nn/functional.py:1949: UserWarning: nn.functional.tanh is deprecated. Use torch.tanh instead.
  warnings.warn("nn.functional.tanh is deprecated. Use torch.tanh instead.")
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torch/nn/functional.py:1949: UserWarning: nn.functional.tanh is deprecated. Use torch.tanh instead.
  warnings.warn("nn.functional.tanh is deprecated. Use torch.tanh instead.")
[W reducer.cpp:1251] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[W reducer.cpp:1251] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[W reducer.cpp:1251] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
INFO:root:Train Epoch: 1 [0/31927 ]	Loss: 4.406583786010742
INFO:root:Train Epoch: 1 [2400/31927 ]	Loss: 1.4173600673675537
INFO:root:Train Epoch: 1 [4800/31927 ]	Loss: 1.3217962980270386
INFO:root:Train Epoch: 1 [7200/31927 ]	Loss: 1.2038154602050781
INFO:root:Accuracy qa: 63.24430823117338
INFO:root:Train Epoch: 2 [0/31927 ]	Loss: 1.0722229480743408
INFO:root:Train Epoch: 2 [2400/31927 ]	Loss: 0.9921224117279053
INFO:root:Train Epoch: 2 [4800/31927 ]	Loss: 0.9421771168708801
INFO:root:Train Epoch: 2 [7200/31927 ]	Loss: 0.8446494936943054
INFO:root:Accuracy qa: 65.95884413309983
INFO:root:Train Epoch: 3 [0/31927 ]	Loss: 0.9574323892593384
INFO:root:Train Epoch: 3 [2400/31927 ]	Loss: 0.8694632053375244
INFO:root:Train Epoch: 3 [4800/31927 ]	Loss: 0.898160457611084
INFO:root:Train Epoch: 3 [7200/31927 ]	Loss: 0.7721375823020935
INFO:root:Accuracy qa: 69.87740805604203
INFO:root:Train Epoch: 4 [0/31927 ]	Loss: 0.6995017528533936
INFO:root:Train Epoch: 4 [2400/31927 ]	Loss: 0.6811955571174622
INFO:root:Train Epoch: 4 [4800/31927 ]	Loss: 0.747572660446167
INFO:root:Train Epoch: 4 [7200/31927 ]	Loss: 0.757727861404419
INFO:root:Accuracy qa: 71.19089316987741
INFO:root:Train Epoch: 5 [0/31927 ]	Loss: 0.7190461754798889
INFO:root:Train Epoch: 5 [2400/31927 ]	Loss: 0.6546002626419067
INFO:root:Train Epoch: 5 [4800/31927 ]	Loss: 0.7959403991699219
INFO:root:Train Epoch: 5 [7200/31927 ]	Loss: 0.6789675354957581
INFO:root:Accuracy qa: 71.93520140105079
INFO:root:Train Epoch: 6 [0/31927 ]	Loss: 0.9579353928565979
INFO:root:Train Epoch: 6 [2400/31927 ]	Loss: 0.6714395880699158
INFO:root:Train Epoch: 6 [4800/31927 ]	Loss: 0.624056339263916
INFO:root:Train Epoch: 6 [7200/31927 ]	Loss: 0.6409541964530945
INFO:root:Accuracy qa: 71.91330998248687
INFO:root:Train Epoch: 7 [0/31927 ]	Loss: 0.7939053773880005
INFO:root:Train Epoch: 7 [2400/31927 ]	Loss: 0.4702972173690796
INFO:root:Train Epoch: 7 [4800/31927 ]	Loss: 0.5875157713890076
INFO:root:Train Epoch: 7 [7200/31927 ]	Loss: 0.6673557758331299
INFO:root:Accuracy qa: 72.15411558669001
INFO:root:Train Epoch: 8 [0/31927 ]	Loss: 0.41423651576042175
INFO:root:Train Epoch: 8 [2400/31927 ]	Loss: 0.5564613342285156
INFO:root:Train Epoch: 8 [4800/31927 ]	Loss: 0.41417551040649414
INFO:root:Train Epoch: 8 [7200/31927 ]	Loss: 0.4791812002658844
INFO:root:Accuracy qa: 72.8984238178634
INFO:root:Train Epoch: 9 [0/31927 ]	Loss: 0.48912620544433594
INFO:root:Train Epoch: 9 [2400/31927 ]	Loss: 0.3191530406475067
INFO:root:Train Epoch: 9 [4800/31927 ]	Loss: 0.3471168279647827
INFO:root:Train Epoch: 9 [7200/31927 ]	Loss: 0.2852151691913605
INFO:root:Accuracy qa: 75.50350262697023
INFO:root:Train Epoch: 10 [0/31927 ]	Loss: 0.3406793475151062
INFO:root:Train Epoch: 10 [2400/31927 ]	Loss: 0.43933528661727905
INFO:root:Train Epoch: 10 [4800/31927 ]	Loss: 0.3026050627231598
INFO:root:Train Epoch: 10 [7200/31927 ]	Loss: 0.24228030443191528
INFO:root:Accuracy qa: 75.74430823117338
INFO:root:Train Epoch: 11 [0/31927 ]	Loss: 0.2752935290336609
INFO:root:Train Epoch: 11 [2400/31927 ]	Loss: 0.24418070912361145
INFO:root:Train Epoch: 11 [4800/31927 ]	Loss: 0.24696746468544006
INFO:root:Train Epoch: 11 [7200/31927 ]	Loss: 0.27546894550323486
INFO:root:Accuracy qa: 75.08756567425569
INFO:root:Train Epoch: 12 [0/31927 ]	Loss: 0.20366284251213074
INFO:root:Train Epoch: 12 [2400/31927 ]	Loss: 0.21549102663993835
INFO:root:Train Epoch: 12 [4800/31927 ]	Loss: 0.27682697772979736
INFO:root:Train Epoch: 12 [7200/31927 ]	Loss: 0.2903861403465271
INFO:root:Accuracy qa: 75.15323992994746
INFO:root:Train Epoch: 13 [0/31927 ]	Loss: 0.18984933197498322
INFO:root:Train Epoch: 13 [2400/31927 ]	Loss: 0.2736586034297943
INFO:root:Train Epoch: 13 [4800/31927 ]	Loss: 0.26890289783477783
INFO:root:Train Epoch: 13 [7200/31927 ]	Loss: 0.24767659604549408
INFO:root:Accuracy qa: 74.84676007005254
INFO:root:Train Epoch: 14 [0/31927 ]	Loss: 0.20892581343650818
INFO:root:Train Epoch: 14 [2400/31927 ]	Loss: 0.1722106635570526
INFO:root:Train Epoch: 14 [4800/31927 ]	Loss: 0.23148596286773682
INFO:root:Train Epoch: 14 [7200/31927 ]	Loss: 0.14670366048812866
INFO:root:Accuracy qa: 75.3940455341506
INFO:root:Train Epoch: 15 [0/31927 ]	Loss: 0.16169291734695435
INFO:root:Train Epoch: 15 [2400/31927 ]	Loss: 0.20697790384292603
INFO:root:Train Epoch: 15 [4800/31927 ]	Loss: 0.13412825763225555
INFO:root:Train Epoch: 15 [7200/31927 ]	Loss: 0.12459833920001984
INFO:root:Accuracy qa: 75.06567425569177
INFO:root:-------------- end of training --------------

nohup: ignoring input
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torch/distributed/launch.py:178: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.23.1
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
INFO:root:********************************************************
INFO:root:****************** Experiment setting ******************
INFO:root:label_train dir --------- ./data/json_update/avqa-train.json
INFO:root:label_val dir ----------- ./data/json_update/avqa-val.json
INFO:root:label_test dir ---------- ./data/json_update/avqa-test.json
INFO:root:audio dir --------------- ./data/feats/vggish
INFO:root:posi_video dir ---------- /data/avst/10f_video_2plus1/
INFO:root:nega_video dir ---------- /data/avst/10f_video_2plus1/
INFO:root:batch size -------------- 24
INFO:root:num of epoches ---------- 15
INFO:root:learning rate ----------- 0.0001
INFO:root:name of model ----------- AVQA_Fusion_Net
INFO:root:train or test ----------- test
INFO:root:model save dir ---------- ./data/checkpoints/checkpoint_loc_glo_3D_end
INFO:root:num of dataloader workers 2
INFO:root:gpu id ------------------ 0,1,2,3
INFO:root:********************************************************
INFO:torch.distributed.distributed_c10d:Added key: store_based_barrier_key:1 to store for rank: 0
INFO:torch.distributed.distributed_c10d:Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
INFO:root:------------ Audio-Visual Spatial-Temporal Model ------------ 

/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.
  warnings.warn(
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=R2Plus1D_18_Weights.KINETICS400_V1`. You can also use `weights=R2Plus1D_18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:root:length of test dataset ----------- 9129
INFO:root:-------------- loading checkpoint ----------------
INFO:root:-------- checkpoint loading successfully ----------
INFO:root:********************************************************
INFO:root:the best epoch ---------- 10
INFO:root:the best train acc ------ 75.74430823117338
INFO:root:********************************************************
/home/jovyan/conda-envs/czl/lib/python3.9/site-packages/torch/nn/functional.py:1949: UserWarning: nn.functional.tanh is deprecated. Use torch.tanh instead.
  warnings.warn("nn.functional.tanh is deprecated. Use torch.tanh instead.")
INFO:root:Audio Counting Accuracy: 82.60 %
INFO:root:Audio Cmp Accuracy: 71.21 %
INFO:root:Audio Accuracy: 78.40 %
INFO:root:Visual Counting Accuracy: 81.95 %
INFO:root:Visual Loc Accuracy: 77.71 %
INFO:root:Visual Accuracy: 79.81 %
INFO:root:AV Ext Accuracy: 82.39 %
INFO:root:AV counting Accuracy: 74.15 %
INFO:root:AV Loc Accuracy: 65.98 %
INFO:root:AV Cmp Accuracy: 66.30 %
INFO:root:AV Temporal Accuracy: 67.15 %
INFO:root:AV Accuracy: 71.45 %
INFO:root:Overall Accuracy: 74.89 %
